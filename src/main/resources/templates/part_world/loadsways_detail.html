<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org">
<head th:include="layout/header :: header(title = #{part_world.loadsways.header})"></head>

<body class="theme-blue"> <!-- right-to-left -->
<span th:replace="fragments/layout_v1.html :: top">top</span>
    <div class="card flex-fill w-100">
        <div class="card-header">
            <h5 class="card-title mb-0" th:text="#{part_world.loadsways.caption}"></h5>
        </div>
        <div class="card-body">
            <div>
                <!--/*@thymesVar id="part_world_loadsways_detail" type="java.util.List"*/-->
                <form id="part-world-loadsways-updater-form" data-toggle="validator" method="post" class="was-validated" th:action="@{/part_world/loadsways__model}">
                    <!--/*@thymesVar id="mode" type="java.lang.Long"*/-->
                    <input type="hidden" id="mode" name="mode" th:value="${mode}">
                    <div class="btn-group mb-2">
                        <button type="submit" class="btn btn-outline-dark mr-1" th:text="#{general.back}" form="part-world-loadsways-indexfrm">Cancel</button>
                        <div th:switch="${mode}">
                            <button th:case="0" type="submit" id="part-world-loadsways-addbtn" class="btn btn-outline-primary" th:text="#{general.addbtn}">Add</button>
                            <button th:case="1" type="submit" id="part-world-loadsways-editbtn" class="btn btn-outline-primary" th:text="#{general.editbtn}">Edit</button>
                            <button th:case="2" type="submit" id="part-world-loadsways-delbtn" class="btn btn-outline-primary" th:text="#{general.delbtn}">Delete</button>
                        </div>
                    </div>
                    <!--suppress ThymeleafVariablesResolveInspection -->
                    <input type="hidden" name="clm_id" th:value="${clm_id}" >
                    <!--suppress ThymeleafVariablesResolveInspection -->
                    <input type="hidden" name="clmtrl_id" th:value="${clmtrl_id}" >
                    <!--suppress ThymeleafVariablesResolveInspection -->
                    <input type="hidden" name="part_world_tab_name" th:value="${part_world_tab_name}" >

                    <!--suppress ThymeleafVariablesResolveInspection -->
                    <input type="hidden" name="part_world_loads_ways_table_order_column" th:value="${part_world_loads_ways_table_order_column}" >
                    <!--suppress ThymeleafVariablesResolveInspection -->
                    <input type="hidden" name="part_world_loads_ways_table_order_type" th:value="${part_world_loads_link_table_order_type}" >
                    <!--suppress ThymeleafVariablesResolveInspection -->
                    <input type="hidden" name="part_world_loads_ways_table_search" th:value="${part_world_loads_ways_table_search}" >
                    <!--suppress ThymeleafVariablesResolveInspection -->
                    <input type="hidden" name="part_world_loads_ways_table_pagelen" th:value="${part_world_loads_ways_table_pagelen}" >
                    <!--suppress ThymeleafVariablesResolveInspection -->
                    <input type="hidden" name="part_world_loads_ways_table_page" th:value="${part_world_loads_ways_table_page}" >                    
                    
                    <!--suppress ThymeleafVariablesResolveInspection -->
                    <input type="hidden" name="part_world_loads_link_table_order_column" th:value="${part_world_loads_link_table_order_column}" >
                    <!--suppress ThymeleafVariablesResolveInspection -->
                    <input type="hidden" name="part_world_loads_link_table_order_type" th:value="${part_world_loads_link_table_order_type}" >
                    <!--suppress ThymeleafVariablesResolveInspection -->
                    <input type="hidden" name="part_world_loads_link_table_search" th:value="${part_world_loads_link_table_search}" >
                    <!--suppress ThymeleafVariablesResolveInspection -->
                    <input type="hidden" name="part_world_loads_link_table_pagelen" th:value="${part_world_loads_link_table_pagelen}" >
                    <!--suppress ThymeleafVariablesResolveInspection -->
                    <input type="hidden" name="part_world_loads_link_table_page" th:value="${part_world_loads_link_table_page}" >

                    <div class="form-row">
                        <div class="col-12 col-md-2 mb-1" id="clm_id_row">
                            <label for="clm_id" class="form-label" th:text="'1. '+ #{part_world.main.clm_id}"></label>
                            <!--suppress ThymeleafVariablesResolveInspection -->
                            <input type="number" class="form-control" id="clm_id" name="clm_id" th:value="${clm_id}">
                            <div class="valid-feedback" th:text="#{general.field_fill}"> Looks good! </div>
                            <div class="invalid-feedback" th:text="#{general.filed_unfilled}"> Bad! </div>
                        </div>
                        <div class="col-12 col-md-2 mb-1" id="clm_num_row">
                            <label for="clm_num" class="form-label" th:text="'2. '+ #{part_world.main.clm_num}"></label>
                            <!--suppress ThymeleafVariablesResolveInspection -->
                            <input type="text" maxlength="16" class="form-control" id="clm_num" name="clm_num" th:value="${clm_num}">
                            <div class="valid-feedback" th:text="#{general.field_fill}"> Looks good! </div>
                            <div class="invalid-feedback" th:text="#{general.filed_unfilled}"> Bad! </div>
                        </div>
                        <div class="col-12 col-md-5 mb-1" id="cnt_name_row">
                            <label for="cnt_name" class="form-label" th:text="'3. '+ #{part_world.main.cnt_name}"></label>
                            <!--suppress ThymeleafVariablesResolveInspection -->
                            <input type="text" class="form-control" id="cnt_name" name="cnt_name" th:value="${cnt_name}">
                            <div class="valid-feedback" th:text="#{general.field_fill}"> Looks good! </div>
                            <div class="invalid-feedback" th:text="#{general.filed_unfilled}"> Bad! </div>
                        </div>
                    </div> <!-- Row 1 -->

                    <div class="form-row">
                        <div class="col-12 col-md-2 mb-1" id="clmtwl_id_row">
                            <label for="clmtwl_id" class="form-label" th:text="'4. '+ #{part_world.loadsways.clmtwl_id}"></label>
                            <!--suppress ThymeleafVariablesResolveInspection -->
                            <input type="number" class="form-control" id="clmtwl_id" name="clmtwl_id" th:value="${clmtwl_id}">
                            <div class="valid-feedback" th:text="#{general.field_fill}"> Looks good! </div>
                            <div class="invalid-feedback" th:text="#{general.filed_unfilled}"> Bad! </div>
                        </div>
                    </div> <!-- Row 2 -->

                    <div class="form-row">
                        <div class="col-12 col-12 col-md-12 mb-1" id="cnt_id_div">
                            <label for="cnt_id" th:text="'5. '+#{part_world.loadsways.clmtwl_name}"></label>
                            <div class="input-group d-flex">
                                <!--suppress ThymeleafVariablesResolveInspection -->
                                <select type="text" id="cnt_id" name="cnt_id" class="form-control p-1" aria-describedby="cnt_id_helpBlock" th:value="${cnt_id}">
                                    <option value=""></option>
                                    <!--suppress ThymeleafVariablesResolveInspection -->
                                    <option class="p-1"
                                            th:each="loadsways : ${loadsways_list}"
                                            th:value="${loadsways.clmwl_id}"
                                            th:text="${loadsways.clmwl_fullname}"
                                            th:selected="${loadsways.clmwl_id == clmwl_id}">
                                    </option>
                                </select>
                                <div class="valid-feedback" th:text="#{general.field_fill}"> Looks good! </div>
                                <div class="invalid-feedback" th:text="#{general.filed_unfilled}"> Bad! </div>
                                <span class="input-group-append">
                                    <button type="button" class="btn btn-outline-primary" id="cnt_id_show" name="cnt_id_show"><i class="fas fa-clipboard-list"></i></button>
                                </span>
                            </div>
                        </div>
                    </div> <!-- Row 3 -->
                </form>
            </div>
        </div>
    </div>

    <!--/*@thymesVar id="part_world_loadsways_detail" type="java.util.List"*/-->
    <form id="part-world-loadsways-indexfrm" method="post" th:action="@{/part_world}" hidden>
        <!--suppress ThymeleafVariablesResolveInspection -->
        <input name="clmtrl_id" th:value="${clmtrl_id}">
        <!--suppress ThymeleafVariablesResolveInspection -->
        <input name="clm_id" th:value="${clm_id}">
        <!--suppress ThymeleafVariablesResolveInspection -->
        <input name="clmtwl_id" th:value="${clmtwl_id}">        
        <!--suppress ThymeleafVariablesResolveInspection -->
        <input name="part_world_tab_name" th:value="${part_world_tab_name}">
        

        <!--suppress ThymeleafVariablesResolveInspection -->
        <input name="table_order_column" th:value="${part_world_loads_ways_table_order_column}" >
        <!--suppress ThymeleafVariablesResolveInspection -->
        <input name="table_order_type" th:value="${part_world_loads_ways_table_order_type}" >
        <!--suppress ThymeleafVariablesResolveInspection -->
        <input name="table_search" th:value="${part_world_loads_ways_table_search}" >
        <!--suppress ThymeleafVariablesResolveInspection -->
        <input name="table_pagelen" th:value="${part_world_loads_ways_table_pagelen}" >
        <!--suppress ThymeleafVariablesResolveInspection -->
        <input name="table_page" th:value="${part_world_loads_ways_table_page}" >        
        
        <!--suppress ThymeleafVariablesResolveInspection -->
        <input name="table_order_column" th:value="${part_world_loads_link_table_order_column}" >
        <!--suppress ThymeleafVariablesResolveInspection -->
        <input name="table_order_type" th:value="${part_world_loads_link_table_order_type}" >
        <!--suppress ThymeleafVariablesResolveInspection -->
        <input name="table_search" th:value="${part_world_loads_link_table_search}" >
        <!--suppress ThymeleafVariablesResolveInspection -->
        <input name="table_pagelen" th:value="${part_world_loads_link_table_pagelen}" >
        <!--suppress ThymeleafVariablesResolveInspection -->
        <input name="table_page" th:value="${part_world_loads_link_table_page}" >
    </form>

<span th:replace="fragments/layout_v1.html :: bottom">bottom</span>

<span th:replace="fragments/error :: errorscript_frm(formname = 'part-world-loadsways-indexfrm')">Error</span>

<script>
    $(document).ready(function(){
<!-- Highlight menu -->
        $('#main_li').removeClass('active');

        $('#tms_li').addClass('active').removeClass('collapsed');
        $('#tms_a').attr('aria-expanded',true);
        $('#tms').addClass('show');

        $('#part_world_a').addClass('text-primary');

<!-- Start Objects -->

        <!-- Form Start -->
        $('#clm_id').prop('readOnly',true);
        $('#clm_num').prop('readOnly',true);
        $('#cnt_name').prop('readOnly',true);

        $('#clm_load_name').prop('required',true);

        if($('#mode').val() === '0'){
            $('#clmtrl_id_row').prop('hidden',true);
        }
        else if($('#mode').val() === '1'){
            $('#clmtrl_id').prop('readOnly',true);
        }
        else{
            $('#clmtrl_id').prop('readOnly',true);

            $('#cnt_id').attr('readOnly',true);
            $('#cnt_id_show').prop('disabled',true).removeClass('btn-outline-primary').addClass('btn-outline-dark');

            $('#cntc_type_id').prop('disabled',true);

            $('#cntc_id').attr('readOnly',true);

            $('#cntt_type_id').prop('disabled',true);

            $('#cntt_id').attr('readOnly',true);

            $('#cntd_id').attr('readOnly',true);
        }

        var cntName =  "Выберите перевозчика";
        var cntFindText = "Введите от 2-х символов";

        $('#cnt_id')
            .wrap("<div class=\"position-relative\"></div>")
            .select2({
                id: '-1', // the value of the option
                placeholder: cntName,
                allowClear: true,
                minimumInputLength: 2,
                language: {
                    inputTooShort: function() {
                        return cntFindText;
                    }}
            });

        $('#cnt_id_show').on('click', function () {
            if($('#cnt_id_show').hasClass('btn-outline-primary')) {
                $('#cnt_id_show').removeClass('btn-outline-primary').addClass('btn-primary');
                var options_zero = {
                    id: '-1', // the value of the option
                    placeholder: cntName,
                    allowClear: true,
                    width: 'element',
                    dropdownAutoWidth: true
                };
                $("#cnt_id").select2("destroy").select2(options_zero);
            }
            else if($('#cnt_id_show').hasClass('btn-primary')){
                $('#cnt_id_show').addClass('btn-outline-primary').removeClass('btn-primary');
                var options_two = {
                    id: '-1', // the value of the option
                    placeholder: cntName,
                    allowClear: true,
                    minimumInputLength: 2,
                    language: {
                        inputTooShort: function() {
                            return cntFindText;
                        }},
                    width: 'element',
                    dropdownAutoWidth: true
                };
                $("#cnt_id").select2("destroy").select2(options_two);
            }
        });

        function carsTypeChange() {
            $('#cntc_type_id').empty();
            $.ajax({
                url:/*[[@{'/hydrawms_new/part_world/get_cars_type'}]]*/ "/hydrawms_new/part_world/get_cars_type",
                type: "get",
                data: {"cnt_id": $('#cnt_id').val()},
                success: function (cntc_type_detail) {
                    for (var i = 0; i < cntc_type_detail.data.length; i++) {
                        if(i === 0) {
                            $("select[name='cntc_type_id']").find('option').end().append("<option value=''></option>");
                        }
                        $("select[name='cntc_type_id']").find('option').end().append("<option value='" + cntc_type_detail.data[i].cntc_type_id + "'>" + cntc_type_detail.data[i].cntc_type_sname + "</option>");
                    }
                }
            });
        }

        function carsChange() {
            $('#cntc_id').empty();
            $.ajax({
                url:/*[[@{'/hydrawms_new/part_world/get_cars'}]]*/ "/hydrawms_new/part_world/get_cars",
                type: "get",
                data: {"cnt_id": $('#cnt_id').val(),
                       "cntc_type_id": $('#cntc_type_id').val()
                },
                success: function (reqdetail) {
                    for (var i = 0; i < reqdetail.data.length; i++) {
                        if(i === 0) {
                            $("select[name='cntc_id']").find('option').end().append("<option value=''></option>");
                        }
                        $("select[name='cntc_id']").find('option').end().append("<option value='" + reqdetail.data[i].cntc_id + "'>" + reqdetail.data[i].cntc_fullname + "</option>");
                    }
                }
            });
        }

        function trailersTypeChange() {
            $('#cntt_type_id').empty();
            $.ajax({
                url:/*[[@{'/hydrawms_new/part_world/get_trailers_type'}]]*/ "/hydrawms_new/part_world/get_trailers_type",
                type: "get",
                data: {"cnt_id": $('#cnt_id').val()},
                success: function (cntt_type_detail) {
                    for (var i = 0; i < cntt_type_detail.data.length; i++) {
                        if(i === 0) {
                            $("select[name='cntt_type_id']").find('option').end().append("<option value=''></option>");
                        }
                        $("select[name='cntt_type_id']").find('option').end().append("<option value='" + cntt_type_detail.data[i].cntt_type_id + "'>" + cntt_type_detail.data[i].cntt_type_sname + "</option>");
                    }
                }
            });
        }

        function trailersChange() {
            $('#cntt_id').empty();
            $.ajax({
                url:/*[[@{'/hydrawms_new/part_world/get_trailers'}]]*/ "/hydrawms_new/part_world/get_trailers",
                type: "get",
                data: {"cnt_id": $('#cnt_id').val(),
                       "cntt_type_id": $('#cntt_type_id').val()
                },
                success: function (reqdetail) {
                    for (var i = 0; i < reqdetail.data.length; i++) {
                        if(i === 0) {
                            $("select[name='cntt_id']").find('option').end().append("<option value=''></option>");
                        }
                        $("select[name='cntt_id']").find('option').end().append("<option value='" + reqdetail.data[i].cntt_id + "'>" + reqdetail.data[i].cntt_fullname + "</option>");
                    }
                }
            });
        }

        function driversChange() {
            $('#cntd_id').empty();
            $.ajax({
                url:/*[[@{'/hydrawms_new/part_world/get_drivers'}]]*/ "/hydrawms_new/part_world/get_drivers",
                type: "get",
                data: {"cnt_id": $('#cnt_id').val()},
                success: function (reqdetail) {
                    for (var i = 0; i < reqdetail.data.length; i++) {
                        if(i === 0) {
                            $("select[name='cntd_id']").find('option').end().append("<option value=''></option>");
                        }
                        $("select[name='cntd_id']").find('option').end().append("<option value='" + reqdetail.data[i].cntd_id + "'>" + reqdetail.data[i].cntd_fullname + "</option>");
                    }
                }
            });
        }
<!-- Change -->
        $('#cnt_id').change(function () {
            carsTypeChange();
            carsChange();
            trailersTypeChange();
            trailersChange();
            driversChange();
        });

        $('#cntc_type_id').change(function () {
            carsChange();
        });

        $('#cntt_type_id').change(function () {
            trailersChange();
        });
    });
</script>
</body>
</html>