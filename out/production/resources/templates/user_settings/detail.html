<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org">
<head th:include="layout/header :: header(title = #{user_settings.header})"></head>

<body class="theme-blue"> <!-- right-to-left -->
<span th:replace="fragments/layout_v1.html :: top">top</span>

<div class="row">
    <div class="col-12">
        <div class="card">
        <div class="card-header">
            <h5 class="card-title mb-0" th:text="#{user_settings.caption}"></h5>
        </div>
        <div class="card-body">
            <div>
                <!--/*@thymesVar id="transports_list_detail_detail" type="java.util.List"*/-->
                <form id="user-settings-detail-pass-form" th:action="@{/user_settings/pass_detail}" method="post">
                    <input type="hidden" name="user_id">
                    <input type="hidden" name="user_name">
                    <input type="hidden" name="user_surname">

                    <input type="hidden" name="pos_name">
                    <input type="hidden" name="role_name">
                    <input type="hidden" name="user_mainphone">
                    <input type="hidden" name="user_email">
                    <input type="hidden" name="user_nonmainphone">
                    <input type="hidden" name="telegram_chatid">
                </form>

                <form id="transports-list-detail-updater-form" data-toggle="validator" method="post" class="was-validated">
                    <!--/*@thymesVar id="mode" type="java.lang.Long"*/-->
                    <div class="form-row">
                        <img th:src="@{/img/user_icon.png}" class="img-fluid rounded-circle mb-2" alt="User Icon" />
                    </div>

                    <div class="btn-group">
                        <div th:switch="${mode}">
                            <button type="button" id="user-settings-detail-editbtn" class="btn btn-outline-primary" th:text="#{general.editbtn}">Edit</button>

                            <button type="submit" id="user-settings-detail-passbtn" form="user-settings-detail-pass-form" class="btn btn-outline-primary" th:text="#{general.passbtn}">Password</button>
                        </div>
                    </div>
                    <!--suppress ThymeleafVariablesResolveInspection -->

                    <div class="form-row">
                        <div class="col-md-1 mb-2" id="user_id_row">
                            <label for="user_id" class="form-label" th:text="'1. '+#{user_settings.user_id}"></label>
                            <!--suppress ThymeleafVariablesResolveInspection -->
                            <input type="number" class="form-control" id="user_id" name="user_id">
                            <div class="valid-feedback" th:text="#{general.field_fill}"> Looks good! </div>
                            <div class="invalid-feedback" th:text="#{general.filed_unfilled}"> Bad! </div>
                        </div>
                        <div class="col-md-3 mb-2">
                            <!--suppress ThymeleafVariablesResolveInspection -->
                            <label for="user_name" class="form-label" th:text="'2. '+#{user_settings.user_name}"></label>
                            <!--suppress ThymeleafVariablesResolveInspection -->
                            <input type="text" maxlength="64" class="form-control" id="user_name" name="user_name">
                            <div class="valid-feedback" th:text="#{general.field_fill}"> Looks good! </div>
                            <div class="invalid-feedback" th:text="#{general.filed_unfilled}"> Bad! </div>
                        </div>
                    </div><!-- First Row -->

                    <div class="form-row">
                        <div class="col-md-3 mb-2" id="pos_id_row">
                            <!--suppress ThymeleafVariablesResolveInspection -->
                            <label for="pos_id" class="form-label" th:text="'3. '+#{user_settings.pos_id}"></label>
                            <!--suppress ThymeleafVariablesResolveInspection -->
                            <input type="hidden" class="form-control" id="pos_id" name="pos_id">
                            <input type="text" maxlength="64" class="form-control" id="pos_name" name="pos_name">
                            <div class="valid-feedback" th:text="#{general.field_fill}"> Looks good! </div>
                            <div class="invalid-feedback" th:text="#{general.filed_unfilled}"> Bad! </div>
                        </div>

                        <div class="col-md-3 mb-2" id="role_id_row">
                            <!--suppress ThymeleafVariablesResolveInspection -->
                            <label for="role_id" class="form-label" th:text="'4. '+#{user_settings.role_id}"></label>
                            <!--suppress ThymeleafVariablesResolveInspection -->
                            <input type="hidden" class="form-control" id="role_id" name="role_id">
                            <input type="text" maxlength="64" class="form-control" id="role_name" name="role_name">
                            <div class="valid-feedback" th:text="#{general.field_fill}"> Looks good! </div>
                            <div class="invalid-feedback" th:text="#{general.filed_unfilled}"> Bad! </div>
                        </div>
                    </div><!-- Second Row -->

                    <div class="form-row">
                        <div class="col-md-4 mb-2" id="user_surname_row">
                            <!--suppress ThymeleafVariablesResolveInspection -->
                            <label for="user_surname" class="form-label" th:text="'5. '+#{user_settings.user_surname}"></label>
                            <!--suppress ThymeleafVariablesResolveInspection -->
                            <input type="text" maxlength="64" class="form-control" id="user_surname" name="user_surname" th:value="${user_surname}">
                            <div class="valid-feedback" th:text="#{general.field_fill}"> Looks good! </div>
                            <div class="invalid-feedback" th:text="#{general.filed_unfilled}"> Bad! </div>
                        </div>
                    </div><!-- Third Row -->

                    <div class="form-row">
                    <div class="col-md-4 mb-2" id="user_mainphone_row">
                        <!--suppress ThymeleafVariablesResolveInspection -->
                        <label for="user_mainphone" class="form-label" th:text="'6. '+#{user_settings.user_mainphone}"></label>
                        <!--suppress ThymeleafVariablesResolveInspection -->
                        <input type="text" maxlength="32" class="form-control" id="user_mainphone" name="user_mainphone" th:value="${user_mainphone}">
                        <div class="valid-feedback" th:text="#{general.field_fill}"> Looks good! </div>
                        <div class="invalid-feedback" th:text="#{general.filed_unfilled}"> Bad! </div>
                    </div>

                    <div class="col-md-4 mb-2" id="user_nonmainphone_row">
                        <!--suppress ThymeleafVariablesResolveInspection -->
                        <label for="user_nonmainphone" class="form-label" th:text="'7. '+#{user_settings.user_nonmainphone}"></label>
                        <!--suppress ThymeleafVariablesResolveInspection -->
                        <input type="text" maxlength="32" class="form-control" id="user_nonmainphone" name="user_nonmainphone" th:value="${user_nonmainphone}">
                        <div class="valid-feedback" th:text="#{general.field_fill}"> Looks good! </div>
                        <div class="invalid-feedback" th:text="#{general.filed_unfilled}"> Bad! </div>
                    </div>
                </div><!-- Forth Row -->

                    <div class="form-row">
                        <div class="col-md-4 mb-2" id="user_email_row">
                            <!--suppress ThymeleafVariablesResolveInspection -->
                            <label for="user_email" class="form-label" th:text="'8. '+#{user_settings.user_email}"></label>
                            <!--suppress ThymeleafVariablesResolveInspection -->
                            <input type="email" maxlength="32" class="form-control" id="user_email" name="user_email" th:value="${user_email}">
                            <div class="valid-feedback" th:text="#{general.field_fill}"> Looks good! </div>
                            <div class="invalid-feedback" th:text="#{general.filed_unfilled}"> Bad! </div>
                        </div>

                        <div class="col-md-2 mb-2" id="telegram_chatid_row">
                            <!--suppress ThymeleafVariablesResolveInspection -->
                            <label for="user_nonmainphone" class="form-label" th:text="'9. '+#{user_settings.telegram_chatid}"></label>
                            <!--suppress ThymeleafVariablesResolveInspection -->
                            <input type="text" maxlength="32" class="form-control" id="telegram_chatid" name="telegram_chatid" th:value="${telegram_chatid}">
                            <div class="valid-feedback" th:text="#{general.field_fill}"> Looks good! </div>
                            <div class="invalid-feedback" th:text="#{general.filed_unfilled}"> Bad! </div>
                        </div>
                    </div><!-- Fifth Row -->
                </form>
            </div>
        </div>
    </div>
    </div>
</div>

<span th:replace="fragments/layout_v1.html :: bottom">bottom</span>

<script>
    $(document).ready(function(){
 <!-- Hihglight menu -->
        $('#main_li').removeClass('active');

        $('#settings_li').addClass('active').removeClass('collapsed');
        $('#settings_a').attr('aria-expanded',true);
        $('#settings').addClass('show');

        $('#user_settings_a').addClass('text-primary');

        <!-- Form Start -->
        $('#user_id').prop('readOnly',true);
        $('#user_name').prop('readOnly',true);

        $('#pos_name').prop('readOnly',true);
        $('#role_name').prop('readOnly',true);

        /*Детализация запросов*/
        $.ajax({
            url:/*[[@{'/hydrawms_new/user_settings/get_user_detail'}]]*/ "/hydrawms_new/user_settings/get_user_detail",
            type: "get",
            success: function (user_detail) {
                $('#user_id').val('').val(user_detail.data[0].user_id);

                $('#user_name').val('').val(user_detail.data[0].user_name);

                $('#pos_id').val('').val(user_detail.data[0].pos_id);
                $('#pos_name').val('').val(user_detail.data[0].pos_name);

                $('#role_id').val('').val(user_detail.data[0].role_id);
                $('#role_name').val('').val(user_detail.data[0].role_name);

                $('#user_surname').val('').val(user_detail.data[0].user_surname);

                $('#user_mainphone').val('').val(user_detail.data[0].user_mainphone);
                $('#user_nonmainphone').val('').val(user_detail.data[0].user_nonmainphone);

                $('#user_email').val('').val(user_detail.data[0].user_email);
                $('#telegram_chatid').val('').val(user_detail.data[0].telegram_chatid);
            }
        });
    });

    $('#user-settings-detail-pass-form').submit(function() {
        $("#user-settings-detail-pass-form input[name=user_id]").val($('#user_id').val());
        $("#user-settings-detail-pass-form input[name=user_name]").val($('#user_name').val());
        $("#user-settings-detail-pass-form input[name=user_surname]").val($('#user_surname').val());

        $("#user-settings-detail-pass-form input[name=pos_name]").val($('#pos_name').val());
        $("#user-settings-detail-pass-form input[name=role_name]").val($('#role_name').val());
        $("#user-settings-detail-pass-form input[name=user_mainphone]").val($('#user_mainphone').val());
        $("#user-settings-detail-pass-form input[name=user_nonmainphone]").val($('#user_nonmainphone').val());
        $("#user-settings-detail-pass-form input[name=user_email]").val($('#user_email').val());
        $("#user-settings-detail-pass-form input[name=telegram_chatid]").val($('#telegram_chatid').val());
    });

    $('#user-settings-detail-editbtn').on('click', function( event ) {
        $.ajax({
            url: /*[[ @{/hydrawms_new/user_settings/edit_user} ]]*/ "/hydrawms_new/user_settings/edit_user",
            type: 'post',
            data: {
                "user_id": $('#user_id').val(),
                "user_surname": $('#user_surname').val(),
                "user_email": $('#user_email').val(),
                "user_mainphone": $('#user_mainphone').val(),
                "user_nonmainphone": $('#user_nonmainphone').val(),
                "telegram_chatid": $('#telegram_chatid').val()
            },
            success: function (result) {
            }
        });
    }); <!-- Edit Detail Button -->
</script>
</body>
</html>